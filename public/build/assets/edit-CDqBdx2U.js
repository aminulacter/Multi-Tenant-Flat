import{d as D,r as f,a as M,z as $,p as z,c as L,w as S,b as E,e as t,u as p,h as O,l as R,f as v,g as q,i as x,j as l,k as y,n as h,v as A,o as d,t as r,F as T,s as V,x as B,m as G}from"./app-C1gjP-sn.js";import{d as C,_ as H}from"./AppLayout.vue_vue_type_script_setup_true_lang-BxnW7pDE.js";import{d as J}from"./index-DUMdsY2H.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-lqOkEa73.js";import"./useForwardExpose-BdW8TFuC.js";import"./VisuallyHidden-COE-oCfJ.js";import"./RovingFocusGroup-CNXrAHiD.js";import"./useArrowNavigation-C6Y-ieo6.js";import"./createLucideIcon-DiNYG7n8.js";const K={class:"py-12"},P={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},Q={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},W={class:"p-6 text-gray-900"},X={class:"flex justify-between items-center mb-6"},Y={key:0,class:"mt-1 text-sm text-red-600"},Z=["value"],I={key:0,class:"mt-1 text-sm text-red-600"},ee=["disabled"],te={value:""},ie=["value"],se={key:0,class:"mt-1 text-sm text-red-600"},ne={class:"flex items-center justify-end space-x-4"},ae=["disabled"],ge=D({__name:"edit",props:{flat:{},buildings:{},tenants:{}},setup(w){const g=w,{flat:o}=g,N=[{title:"Dashboard",href:J().url},{title:"Flats",href:C().url},{title:"Edit Flat",href:"#"}],m=f(!1),n=f({}),u=f([]),c=f(!1),s=M({name:"",building_id:null,tenant_id:null}),U=()=>{m.value=!0,n.value={};try{const a={name:s.name,building_id:s.building_id,tenant_id:s.tenant_id};G.put(`/flats/${o.id}`,a,{onSuccess:()=>{},onError:e=>{n.value=e},onFinish:()=>{m.value=!1}})}catch(a){console.error("Form submission error:",a),m.value=!1}},k=async a=>{if(!a){u.value=[];return}c.value=!0;try{const e=g.buildings.find(i=>i.id===a);if(e){const _=await(await fetch(`/getavailabletenants?house_owner_id=${e.house_owner_id}`)).json();if(o.tenant_id&&!_.find(b=>b.id===o.tenant_id)){const b=g.tenants.find(j=>j.id===o.tenant_id);b&&_.push(b)}u.value=_}}catch(e){console.error("Error fetching tenants:",e),u.value=[]}finally{c.value=!1}};$(()=>s.building_id,a=>{a?k(a):u.value=[]});const F=()=>{s.name=o.name||"",s.building_id=o.building_id||null,s.tenant_id=o.tenant_id||null,u.value=[],n.value={}};return z(()=>{F(),o.building_id&&k(o.building_id)}),(a,e)=>(d(),L(H,{breadcrumbs:N},{default:S(()=>[E(p(O),{title:"Edit Flat"}),t("div",K,[t("div",P,[t("div",Q,[t("div",W,[t("div",X,[e[4]||(e[4]=t("h1",{class:"text-2xl font-bold text-gray-900"},"Edit Flat",-1)),E(p(R),{href:p(C)().url,class:"bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-md transition-colors"},{default:S(()=>[...e[3]||(e[3]=[v(" Back ",-1)])]),_:1},8,["href"])]),t("form",{onSubmit:q(U,["prevent"]),class:"space-y-6"},[t("div",null,[e[5]||(e[5]=t("label",{for:"name",class:"block text-sm font-medium text-gray-700"},[v(" Flat Name "),t("span",{class:"text-red-500"},"*")],-1)),x(t("input",{id:"name","onUpdate:modelValue":e[0]||(e[0]=i=>s.name=i),type:"text",class:h(["mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",{"border-red-500":n.value.name}]),placeholder:"Enter flat name"},null,2),[[A,s.name]]),n.value.name?(d(),l("p",Y,r(n.value.name),1)):y("",!0)]),t("div",null,[e[7]||(e[7]=t("label",{for:"building_id",class:"block text-sm font-medium text-gray-700"},[v(" Building "),t("span",{class:"text-red-500"},"*")],-1)),x(t("select",{id:"building_id","onUpdate:modelValue":e[1]||(e[1]=i=>s.building_id=i),class:h(["mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",{"border-red-500":n.value.building_id}])},[e[6]||(e[6]=t("option",{value:""},"Select a building",-1)),(d(!0),l(T,null,V(w.buildings,i=>(d(),l("option",{key:i.id,value:i.id},r(i.name),9,Z))),128))],2),[[B,s.building_id]]),n.value.building_id?(d(),l("p",I,r(n.value.building_id),1)):y("",!0)]),t("div",null,[e[8]||(e[8]=t("label",{for:"tenant_id",class:"block text-sm font-medium text-gray-700"}," Tenant (Optional) ",-1)),x(t("select",{id:"tenant_id","onUpdate:modelValue":e[2]||(e[2]=i=>s.tenant_id=i),class:h(["mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",{"border-red-500":n.value.tenant_id}]),disabled:!s.building_id||c.value},[t("option",te,r(s.building_id?c.value?"Loading tenants...":"Select a tenant (optional)":"Select a building first"),1),(d(!0),l(T,null,V(u.value,i=>(d(),l("option",{key:i.id,value:i.id},r(i.name),9,ie))),128))],10,ee),[[B,s.tenant_id]]),n.value.tenant_id?(d(),l("p",se,r(n.value.tenant_id),1)):y("",!0)]),t("div",ne,[t("button",{type:"button",onClick:F,class:"bg-gray-300 hover:bg-gray-400 text-gray-800 px-4 py-2 rounded-md transition-colors"}," Reset "),t("button",{type:"submit",disabled:m.value,class:"bg-indigo-600 hover:bg-indigo-700 disabled:bg-indigo-400 text-white px-4 py-2 rounded-md transition-colors"},r(m.value?"Updating...":"Update Flat"),9,ae)])],32)])])])])]),_:1}))}});export{ge as default};
