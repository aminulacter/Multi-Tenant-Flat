import{d as v,p as w,r as i,a as x,j as b,b as n,u as l,h as y,w as a,e as r,l as C,f as S,t as c,g as k,F as z,m as E,o as U}from"./app-C1gjP-sn.js";import{_ as $}from"./AppLayout.vue_vue_type_script_setup_true_lang-BxnW7pDE.js";import{d as D}from"./index-DUMdsY2H.js";import{W as j}from"./style-B6TQ_5ut.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-lqOkEa73.js";import"./useForwardExpose-BdW8TFuC.js";import"./VisuallyHidden-COE-oCfJ.js";import"./RovingFocusGroup-CNXrAHiD.js";import"./useArrowNavigation-C6Y-ieo6.js";import"./createLucideIcon-DiNYG7n8.js";const N={class:"text-info"},R={class:"flex items-center gap-2"},A={class:"font-semibold"},B=["href"],F={class:"flex items-center gap-2"},M={class:"text-gray-600"},V={class:"flex items-center gap-2"},q=["onClick"],Y=v({__name:"index",setup(P){const _=[{title:"Dashboard",href:D().url}];w(()=>{u()});const d=i(!0),m=i(0),s=x({current_page:1,pagesize:10,sort_column:"id",sort_direction:"asc"}),p=i(null),f=i([{field:"id",title:"ID",isUnique:!0,type:"number"},{field:"name",title:"Name"},{field:"email",title:"Email"},{field:"role_name",title:"Role"},{field:"actions",title:"Actions",sort:!1}])||[],u=async()=>{try{d.value=!0;const o=new URLSearchParams({page:s.current_page.toString(),per_page:s.pagesize.toString(),sort_column:s.sort_column,sort_direction:s.sort_direction}),t=await fetch(`/getusers?${o}`,{headers:{Accept:"application/json"}});if(!t.ok)throw new Error(`Failed to fetch: ${t.status}`);const e=await t.json();p.value=e?.data,m.value=e?.pagination?.total}catch(o){console.error("Error fetching users:",o)}d.value=!1},g=o=>{s.current_page=o.current_page,s.pagesize=o.pagesize,s.sort_column=o.sort_column,s.sort_direction=o.sort_direction,u()},h=o=>{confirm("Are you sure you want to delete this user?")&&E.delete(`/users/${o}`,{onSuccess:()=>{u()},onError:t=>{console.error("Error deleting user:",t)}})};return(o,t)=>(U(),b(z,null,[n(l(y),{title:"Users"}),n($,{breadcrumbs:_},{default:a(()=>[t[2]||(t[2]=r("div",{class:"flex justify-between items-center px-4 py-2"},[r("h1",null,"Users"),r("a",{href:"/users/create",class:"bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-md transition-colors"},"Create User")],-1)),n(l(j),{rows:p.value,columns:l(f),loading:d.value,totalRows:m.value,isServerMode:!0,pageSize:s.pagesize,sortable:!0,sortColumn:s.sort_column,sortDirection:s.sort_direction,class:"advanced-table whitespace-nowrap",onChange:g},{id:a(e=>[r("strong",N,"#"+c(e.value.id),1)]),name:a(e=>[r("div",R,[r("div",A,c(e.value.name),1)])]),email:a(e=>[r("a",{href:`mailto:${e.value.email}`,class:"text-primary hover:underline",onClick:t[0]||(t[0]=k(()=>{},["stop"]))},c(e.value.email),9,B)]),role_name:a(e=>[r("div",F,[r("div",M,c(e.value.role_name),1)])]),actions:a(e=>[r("div",V,[n(l(C),{href:`/users/${e.value.id}/edit`,class:"bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded text-sm transition-colors"},{default:a(()=>[...t[1]||(t[1]=[S("Edit",-1)])]),_:1},8,["href"]),r("button",{class:"bg-red-600 hover:bg-red-700 text-white px-3 py-1 rounded text-sm transition-colors",onClick:W=>h(e.value.id)},"Delete",8,q)])]),_:1},8,["rows","columns","loading","totalRows","pageSize","sortColumn","sortDirection"])]),_:1})],64))}});export{Y as default};
